<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.110.0"><meta name=description content="An unofficial Microbit v2 API reference & guide book."><meta name=author content="c272"><link rel=icon href=/images/favicon.png type=image/png><title>Compass - micro:bit v2 Documentation</title><link href=/css/nucleus.css?1675176782 rel=stylesheet><link href=/css/fontawesome-all.min.css?1675176782 rel=stylesheet><link href=/css/hybrid.css?1675176782 rel=stylesheet><link href=/css/featherlight.min.css?1675176782 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1675176782 rel=stylesheet><link href=/css/auto-complete.css?1675176782 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1675176782 rel=stylesheet><link href=/css/theme.css?1675176782 rel=stylesheet><link href=/css/tabs.css?1675176782 rel=stylesheet><link href=/css/hugo-theme.css?1675176782 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1675176782></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style></head><body data-url=/api-reference/core/compass/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><img id=grav-logo src=/images/logo.png style=width:100%;height:100%></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1675176782></script>
<script type=text/javascript src=/js/auto-complete.js?1675176782></script>
<script type=text/javascript>var baseurl="https://microbit.c272.org/"</script><script type=text/javascript src=/js/search.js?1675176782></script></div><section id=homelinks><ul><li><a class=padding href=/><i class='fas fa-home'></i> Home</a></li></ul></section><div class=highlightable><ul class=topics><li data-nav-id=/setup/ title=Setup class=dd-item><a href=/setup/><b>1. </b>Setup</a><ul><li data-nav-id=/setup/linux-install-guide/ title="Installing on Linux" class=dd-item><a href=/setup/linux-install-guide/>Installing on Linux</a></li><li data-nav-id=/setup/mac-install-guide/ title="Installing on MacOS" class=dd-item><a href=/setup/mac-install-guide/>Installing on MacOS</a></li><li data-nav-id=/setup/windows-install-guide/ title="Installing on Windows" class=dd-item><a href=/setup/windows-install-guide/>Installing on Windows</a></li><li data-nav-id=/setup/using-micro-tools/ title="Configuring & Using micro-tools" class=dd-item><a href=/setup/using-micro-tools/>Configuring & Using micro-tools</a></li><li data-nav-id=/setup/debug-setup-guide/ title="Setting up a Debug Environment" class=dd-item><a href=/setup/debug-setup-guide/>Setting up a Debug Environment</a></li></ul></li><li data-nav-id=/guides/ title=Guides class=dd-item><a href=/guides/><b>2. </b>Guides</a><ul><li data-nav-id=/guides/hello-world/ title="'Hello World' with micro:bit v2" class=dd-item><a href=/guides/hello-world/>'Hello World' with micro:bit v2</a></li><li data-nav-id=/guides/using-the-filesystem/ title="Using the micro:bit file system" class=dd-item><a href=/guides/using-the-filesystem/>Using the micro:bit file system</a></li><li data-nav-id=/guides/logging/ title="Logging with MicroBitLog" class=dd-item><a href=/guides/logging/>Logging with MicroBitLog</a></li><li data-nav-id=/guides/serial/ title="Interacting over serial I/O" class=dd-item><a href=/guides/serial/>Interacting over serial I/O</a></li></ul></li><li data-nav-id=/api-reference/ title="API Reference" class="dd-item
parent"><a href=/api-reference/><b>3. </b>API Reference</a><ul><li data-nav-id=/api-reference/core/ title=codal-core class="dd-item
parent"><a href=/api-reference/core/>codal-core</a><ul><li data-nav-id=/api-reference/core/accelerometer/ title=Accelerometer class=dd-item><a href=/api-reference/core/accelerometer/>Accelerometer</a></li><li data-nav-id=/api-reference/core/button/ title=Button class=dd-item><a href=/api-reference/core/button/>Button</a></li><li data-nav-id=/api-reference/core/compass/ title=Compass class="dd-item active"><a href=/api-reference/core/compass/>Compass</a></li><li data-nav-id=/api-reference/core/coordinatespace/ title=CoordinateSpace class=dd-item><a href=/api-reference/core/coordinatespace/>CoordinateSpace</a></li><li data-nav-id=/api-reference/core/keyvaluestorage/ title=KeyValueStorage class=dd-item><a href=/api-reference/core/keyvaluestorage/>KeyValueStorage</a></li><li data-nav-id=/api-reference/core/ledmatrix/ title=LEDMatrix class=dd-item><a href=/api-reference/core/ledmatrix/>LEDMatrix</a></li><li data-nav-id=/api-reference/core/managedbuffer/ title=ManagedBuffer class=dd-item><a href=/api-reference/core/managedbuffer/>ManagedBuffer</a></li><li data-nav-id=/api-reference/core/managedstring/ title=ManagedString class=dd-item><a href=/api-reference/core/managedstring/>ManagedString</a></li><li data-nav-id=/api-reference/core/messagebus/ title=MessageBus class=dd-item><a href=/api-reference/core/messagebus/>MessageBus</a></li><li data-nav-id=/api-reference/core/multibutton/ title=MultiButton class=dd-item><a href=/api-reference/core/multibutton/>MultiButton</a></li><li data-nav-id=/api-reference/core/nvmcontroller/ title=NVMController class=dd-item><a href=/api-reference/core/nvmcontroller/>NVMController</a></li><li data-nav-id=/api-reference/core/pin/ title=Pin class=dd-item><a href=/api-reference/core/pin/>Pin</a></li><li data-nav-id=/api-reference/core/sample3d/ title=Sample3D class=dd-item><a href=/api-reference/core/sample3d/>Sample3D</a></li><li data-nav-id=/api-reference/core/timer/ title=Timer class=dd-item><a href=/api-reference/core/timer/>Timer</a></li><li data-nav-id=/api-reference/core/touchbutton/ title=TouchButton class=dd-item><a href=/api-reference/core/touchbutton/>TouchButton</a></li><li data-nav-id=/api-reference/core/license/ title="License & Attribution" class=dd-item><a href=/api-reference/core/license/>License & Attribution</a></li></ul></li><li data-nav-id=/api-reference/microbit-v2/ title=codal-microbit-v2 class=dd-item><a href=/api-reference/microbit-v2/>codal-microbit-v2</a><ul><li data-nav-id=/api-reference/microbit-v2/microbit/ title=MicroBit class=dd-item><a href=/api-reference/microbit-v2/microbit/>MicroBit</a></li><li data-nav-id=/api-reference/microbit-v2/microbitaudio/ title=MicroBitAudio class=dd-item><a href=/api-reference/microbit-v2/microbitaudio/>MicroBitAudio</a></li><li data-nav-id=/api-reference/microbit-v2/microbitblemanager/ title=MicroBitBLEManager class=dd-item><a href=/api-reference/microbit-v2/microbitblemanager/>MicroBitBLEManager</a></li><li data-nav-id=/api-reference/microbit-v2/microbitcompasscalibrator/ title=MicroBitCompassCalibrator class=dd-item><a href=/api-reference/microbit-v2/microbitcompasscalibrator/>MicroBitCompassCalibrator</a></li><li data-nav-id=/api-reference/microbit-v2/microbitdisplay/ title=MicroBitDisplay class=dd-item><a href=/api-reference/microbit-v2/microbitdisplay/>MicroBitDisplay</a></li><li data-nav-id=/api-reference/microbit-v2/microbiti2c/ title=MicroBitI2C class=dd-item><a href=/api-reference/microbit-v2/microbiti2c/>MicroBitI2C</a></li><li data-nav-id=/api-reference/microbit-v2/microbitio/ title=MicroBitIO class=dd-item><a href=/api-reference/microbit-v2/microbitio/>MicroBitIO</a></li><li data-nav-id=/api-reference/microbit-v2/microbitlog/ title=MicroBitLog class=dd-item><a href=/api-reference/microbit-v2/microbitlog/>MicroBitLog</a></li><li data-nav-id=/api-reference/microbit-v2/microbitpowermanager/ title=MicroBitPowerManager class=dd-item><a href=/api-reference/microbit-v2/microbitpowermanager/>MicroBitPowerManager</a></li><li data-nav-id=/api-reference/microbit-v2/microbitradio/ title=MicroBitRadio class=dd-item><a href=/api-reference/microbit-v2/microbitradio/>MicroBitRadio</a></li><li data-nav-id=/api-reference/microbit-v2/microbitthermometer/ title=MicroBitThermometer class=dd-item><a href=/api-reference/microbit-v2/microbitthermometer/>MicroBitThermometer</a></li><li data-nav-id=/api-reference/microbit-v2/microbitusbflashmanager/ title=MicroBitUSBFlashManager class=dd-item><a href=/api-reference/microbit-v2/microbitusbflashmanager/>MicroBitUSBFlashManager</a></li><li data-nav-id=/api-reference/microbit-v2/license/ title="License & Attribution" class=dd-item><a href=/api-reference/microbit-v2/license/>License & Attribution</a></li></ul></li><li data-nav-id=/api-reference/nrf52/ title=codal-nrf52 class=dd-item><a href=/api-reference/nrf52/>codal-nrf52</a><ul><li data-nav-id=/api-reference/nrf52/nrf52adc/ title=NRF52ADC class=dd-item><a href=/api-reference/nrf52/nrf52adc/>NRF52ADC</a></li><li data-nav-id=/api-reference/nrf52/nrf52flashmanager/ title=NRF52FlashManager class=dd-item><a href=/api-reference/nrf52/nrf52flashmanager/>NRF52FlashManager</a></li><li data-nav-id=/api-reference/nrf52/nrf52pin/ title=NRF52Pin class=dd-item><a href=/api-reference/nrf52/nrf52pin/>NRF52Pin</a></li><li data-nav-id=/api-reference/nrf52/nrf52serial/ title=NRF52Serial class=dd-item><a href=/api-reference/nrf52/nrf52serial/>NRF52Serial</a></li><li data-nav-id=/api-reference/nrf52/nrf52touchsensor/ title=NRF52TouchSensor class=dd-item><a href=/api-reference/nrf52/nrf52touchsensor/>NRF52TouchSensor</a></li><li data-nav-id=/api-reference/nrf52/nrflowleveltimer/ title=NRFLowLevelTimer class=dd-item><a href=/api-reference/nrf52/nrflowleveltimer/>NRFLowLevelTimer</a></li><li data-nav-id=/api-reference/nrf52/license/ title="License & Attribution" class=dd-item><a href=/api-reference/nrf52/license/>License & Attribution</a></li></ul></li></ul></li></ul><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> by <a href=https://github.com/c272>C272</a>.<br></p><p style=color:#64586e;margin-top:.5em>This site is not affiliated, associated, authorized, or endorsed by the BBC or Lancaster University.</p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/>Home</a> > <a href=/api-reference/>API Reference</a> > <a href=/api-reference/core/>codal-core</a> > Compass</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#usage--examples>Usage & Examples</a></li><li><a href=#methods>Methods</a><ul><li><a href=#compasscoordinatespace->Compass(CoordinateSpace, &mldr;)</a></li><li><a href=#compassaccelerometer-coordinatespace->Compass(Accelerometer, CoordinateSpace, &mldr;)</a></li><li><a href=#heading>heading()</a></li><li><a href=#getfieldstrength>getFieldStrength()</a></li><li><a href=#calibrate>calibrate()</a></li><li><a href=#setcalibrationcompasscalibration>setCalibration(CompassCalibration)</a></li><li><a href=#getcalibration>getCalibration()</a></li><li><a href=#iscalibrated>isCalibrated()</a></li><li><a href=#iscalibrating>isCalibrating()</a></li><li><a href=#clearcalibration>clearCalibration()</a></li><li><a href=#setaccelerometeraccelerometer>setAccelerometer(Accelerometer)</a></li><li><a href=#configure>configure()</a></li><li><a href=#setperiodint>setPeriod(int)</a></li><li><a href=#getperiodint>getPeriod(int)</a></li><li><a href=#requestupdate>requestUpdate()</a></li><li><a href=#update>update()</a></li><li><a href=#getsamplecoordinatesystem>getSample(CoordinateSystem)</a></li><li><a href=#getsample>getSample()</a></li><li><a href=#getx>getX()</a></li><li><a href=#gety>getY()</a></li><li><a href=#getz>getZ()</a></li></ul></li><li><a href=#structs>Structs</a><ul><li><a href=#compasscalibration>CompassCalibration</a></li></ul></li><li><a href=#class-definition>Class Definition</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Compass</h1><div style=margin:auto;text-align:center;width:><p>A compass abstraction. Reads the magnetometer to determine the orientation of the device, applying tilt compensation from data provided by the accelerometer.</p><p><strong>Version:</strong> <code>ac276de</code><br><strong>Canonical type name:</strong> <code>codal::Compass</code><br><strong>Defined within:</strong> <code>inc/driver-models/Compass.h</code></p></div><h2 id=usage--examples>Usage & Examples</h2><p>One use case for the compass may be to detect when the compass is pointing in a certain direction, for instance, north. For this example we will use the compass created in <a href=/api-reference/microbit-v2/microbit/>MicroBit</a> for ease of use, however this is identical with a manually created instance of the class. To detect whether the current heading is within a range of north, we can do something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>uint8_t</span> tolerance <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> heading <span style=color:#f92672>=</span> uBit.compass.heading();
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (heading <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>360</span> <span style=color:#f92672>-</span> tolerance <span style=color:#f92672>||</span> heading <span style=color:#f92672>&lt;</span> tolerance) {
</span></span><span style=display:flex><span>    uBit.display.scroll(<span style=color:#e6db74>&#34;NORTH&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This will detect the micro:bit as pointing &ldquo;north&rdquo; if the heading provided by the compass is within 10 degrees of magnetic north, according to the last reading. We can also adjust the tolerance by altering the <code>tolerance</code> variable, providing it&rsquo;s under 180 degrees.</p><h2 id=methods>Methods</h2><h3 id=compasscoordinatespace->Compass(CoordinateSpace, &mldr;)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>Compass(CoordinateSpace <span style=color:#f92672>&amp;</span>coordinateSpace, <span style=color:#66d9ef>uint16_t</span> id <span style=color:#f92672>=</span> DEVICE_ID_COMPASS);
</span></span></code></pre></div><p>Creates the software compass abstraction with the given default coordinate space. Does not utilise an accelerometer for tilt compensation.</p><p><strong>Parameters</strong><br>- <code>coordinateSpace</code> (<em><a href=/api-reference/core/coordinatespace/>CoordinateSpace</a>&</em>): The coordinate space that this compass returns samples in by default.<br>- <code>id</code> (<em>uint16_t</em>, optional): The event system ID to use for this compass. By default, is <code>DEVICE_ID_COMPASS</code>.</p><h3 id=compassaccelerometer-coordinatespace->Compass(Accelerometer, CoordinateSpace, &mldr;)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>Compass(Accelerometer <span style=color:#f92672>&amp;</span>accel, CoordinateSpace <span style=color:#f92672>&amp;</span>coordinateSpace, <span style=color:#66d9ef>uint16_t</span> id <span style=color:#f92672>=</span> DEVICE_ID_COMPASS);
</span></span></code></pre></div><p>Creates the software compass abstraction with the given default coordinate space. Utilises the provided accelerometer for tilt compensation.</p><p><strong>Parameters</strong><br>- <code>accel</code> (<em><a href=/api-reference/core/accelerometer/>Accelerometer</a>&</em>): The accelerometer to use for tilt compensation.<br>- <code>coordinateSpace</code> (<em><a href=/api-reference/core/coordinatespace/>CoordinateSpace</a>&</em>): The coordinate space that this compass returns samples in by default.<br>- <code>id</code> (<em>uint16_t</em>, optional): The event system ID to use for this compass. By default, is <code>DEVICE_ID_COMPASS</code>.</p><h3 id=heading>heading()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>heading</span>();
</span></span></code></pre></div><p>Gets the current heading of the device in relation to magnetic north. If the compass is uncalibrated, this will raise the <code>COMPASS_EVT_CALIBRATE</code> signal. If you wish to implement your own compass calibration algorithm instead of using the default, attach a handler for this event of call type <code>MESSAGE_BUS_LISTENER_IMMEDIATE</code> to ensure the calibration is run before user code continues. Note that if you&rsquo;re using the compass from <a href=/api-reference/microbit-v2/microbit/>MicroBit</a>, then you will also have to detach the <a href=/api-reference/microbit-v2/microbitcompasscalibrator/>MicroBitCompassCalibrator</a> event handler first.</p><p><strong>Returns</strong> - The current heading in degrees. If the compass is currently calibrating, returns <code>CALIBRATION_IN_PROGRESS</code>.</p><h3 id=getfieldstrength>getFieldStrength()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getFieldStrength</span>();
</span></span></code></pre></div><p>Returns the current overall magnetic field strength as read from the latest magnetometer update.</p><p><strong>Returns</strong> - The magnetic force read across all axes, in nano teslas.</p><h3 id=calibrate>calibrate()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>calibrate</span>();
</span></span></code></pre></div><p>Called automatically when the user attempts to fetch readings when the compass is uncalibrated. Can also be called manually by the user before use to set up the compass. This is a blocking method, and will only return once calibration is complete.</p><p><strong>Returns</strong> - <code>DEVICE_OK</code> on successful calibration. If the magnetometer was inaccessible, returns <code>DEVICE_I2C_ERROR</code>. If the calibration algorithm failed to complete successfully, returns <code>DEVICE_CALIBRATION_REQUIRED</code>.</p><h3 id=setcalibrationcompasscalibration>setCalibration(CompassCalibration)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setCalibration</span>(CompassCalibration calibration);
</span></span></code></pre></div><p>Configures the compass to use the calibration data passed. If you wish to calibrate without existing data, instead call <code>calibrate()</code>.</p><p><strong>Parameters</strong><br>- <code>calibration</code> (<em><a href=#compasscalibration>CompassCalibration</a></em>): The calibration data to configure the compass with.</p><h3 id=getcalibration>getCalibration()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>CompassCalibration <span style=color:#a6e22e>getCalibration</span>();
</span></span></code></pre></div><p>Returns the currently in-use compass calibration data.</p><p><strong>Returns</strong> - The compass&rsquo; <a href=#compasscalibration>CompassCalibration</a> data struct.</p><h3 id=iscalibrated>isCalibrated()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>isCalibrated</span>();
</span></span></code></pre></div><p>Returns whether the compass is currently calibrated or not.</p><p><strong>Returns</strong> - If the compass is calibrated, 1. Otherwise, 0.</p><h3 id=iscalibrating>isCalibrating()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>isCalibrating</span>();
</span></span></code></pre></div><p>Returns whether the compass is currently being calibrated or not.</p><p><strong>Returns</strong> - If the compass is currently being calibrated, 1. Otherwise, 0.</p><h3 id=clearcalibration>clearCalibration()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>clearCalibration</span>();
</span></span></code></pre></div><p>Clears the currently stored calibration data, and sets the calibration flag (as returned by <code>isCalibrated</code>) to zero.</p><h3 id=setaccelerometeraccelerometer>setAccelerometer(Accelerometer)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setAccelerometer</span>(Accelerometer <span style=color:#f92672>&amp;</span>accelerometer);
</span></span></code></pre></div><p>Sets the accelerometer that is used by the compass for tilt compensation.</p><p><strong>Parameters</strong><br>- <code>accelerometer</code> (<em><a href=/api-reference/core/accelerometer/>Accelerometer</a>&</em>): The accelerometer to use for tilt compensation.</p><h3 id=configure>configure()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>configure</span>();
</span></span></code></pre></div><p>Configures the underlying hardware to reflect the sample rate set in the class. Once complete, instance variables are updated to reflect the changes made (requested periods may have been rounded down due to lack of hardware support).</p><p><strong>Returns</strong> - <code>DEVICE_OK</code> on success. Failure to configure the underlying hardware will return <code>DEVICE_I2C_ERROR</code>.</p><h3 id=setperiodint>setPeriod(int)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>setPeriod</span>(<span style=color:#66d9ef>int</span> period);
</span></span></code></pre></div><p>Attempts to set the sample rate of the compass to the given millisecond period. If the requested rate is not available on the hardware, the next lowest rate will be selected.</p><p><strong>Parameters</strong><br>- <code>period</code> (<em>int</em>): The new period (in milliseconds) between samples.</p><p><strong>Returns</strong> - <code>DEVICE_OK</code> on success. Failure to set period will return <code>DEVICE_I2C_ERROR</code>.</p><h3 id=getperiodint>getPeriod(int)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getPeriod</span>();
</span></span></code></pre></div><p>Returns the current sample period for the compass.</p><p><strong>Returns</strong> - The current sample period, in milliseconds.</p><h3 id=requestupdate>requestUpdate()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>requestUpdate</span>();
</span></span></code></pre></div><p><div class="notices note"><p>This does not usually need to be called explicitly by the user, as sample data is typically updated passively when the scheduler is idle, however this can be used to force the compass to grab the latest available data.</p></div>Polls the hardware to check if new sample data is available. If so, update the stored sample data.</p><p><strong>Returns</strong> - <code>DEVICE_OK</code> on success. Failure to update will return <code>DEVICE_I2C_ERROR</code>.</p><h3 id=update>update()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>update</span>();
</span></span></code></pre></div><p>Update tick function to grab sensor data for the compass and perform gesture tracking. This is called from the scheduler as a fiber component on first call, so does not need to be explicitly repeatedly called by the user.</p><p><strong>Returns</strong> - <code>DEVICE_OK</code> on success. Failure to read data will return <code>DEVICE_I2C_ERROR</code>.</p><h3 id=getsamplecoordinatesystem>getSample(CoordinateSystem)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>Sample3D <span style=color:#a6e22e>getSample</span>(CoordinateSystem coordinateSystem);
</span></span></code></pre></div><p>Reads the last stored compass data, converting it into the provided coordinate system before returning it.</p><p><strong>Parameters</strong><br>- <code>coordinateSystem</code> (<em><a href=/api-reference/core/coordinatespace/#coordinatesystem>CoordinateSystem</a></em>): The type of coordinate system to return the sample as.</p><p><strong>Returns</strong> - A <a href=/api-reference/core/sample3d/>Sample3D</a> of the most recently stored compass data.</p><h3 id=getsample>getSample()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>Sample3D <span style=color:#a6e22e>getSample</span>();
</span></span></code></pre></div><p>Reads the last stored compass data, returning it in the default coordinate space for this compass (constructor value <code>coordinateSpace</code>).</p><p><strong>Returns</strong> - A <a href=/api-reference/core/sample3d/>Sample3D</a> of the most recently stored compass data.</p><h3 id=getx>getX()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getX</span>();
</span></span></code></pre></div><p>Reads the X component of the last stored compass data in the default coordinate space for this compass (constructor value <code>coordinateSpace</code>).</p><p><strong>Returns</strong> - The X component of the most recently stored compass data.</p><h3 id=gety>getY()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getY</span>();
</span></span></code></pre></div><p>Reads the Y component of the last stored compass data in the default coordinate space for this compass (constructor value <code>coordinateSpace</code>).</p><p><strong>Returns</strong> - The Y component of the most recently stored compass data.</p><h3 id=getz>getZ()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getZ</span>();
</span></span></code></pre></div><p>Reads the Z component of the last stored compass data in the default coordinate space for this compass (constructor value <code>coordinateSpace</code>).</p><p><strong>Returns</strong> - The Z component of the most recently stored compass data.</p><h2 id=structs>Structs</h2><h3 id=compasscalibration>CompassCalibration</h3><p>Represents calibration information for the compass.</p><ul><li><code>centre</code>: The zero offset of the compass.</li><li><code>scale</code>: The scale offset to apply in each axis.</li><li><code>radius</code>: The field strength (units from the center to the outermost sample).</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>CompassCalibration</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    Sample3D centre;
</span></span><span style=display:flex><span>    Sample3D scale;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> radius;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    CompassCalibration() <span style=color:#f92672>:</span> centre(), scale(<span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>1024</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        radius <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=class-definition>Class Definition</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Compass</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> CodalComponent
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        Compass(CoordinateSpace <span style=color:#f92672>&amp;</span>coordinateSpace, <span style=color:#66d9ef>uint16_t</span> id <span style=color:#f92672>=</span> DEVICE_ID_COMPASS);
</span></span><span style=display:flex><span>        Compass(Accelerometer <span style=color:#f92672>&amp;</span>accel, CoordinateSpace <span style=color:#f92672>&amp;</span>coordinateSpace, <span style=color:#66d9ef>uint16_t</span> id <span style=color:#f92672>=</span> DEVICE_ID_COMPASS);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>heading</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getFieldStrength</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>calibrate</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setCalibration</span>(CompassCalibration calibration);
</span></span><span style=display:flex><span>        CompassCalibration <span style=color:#a6e22e>getCalibration</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>isCalibrated</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>isCalibrating</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>clearCalibration</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setAccelerometer</span>(Accelerometer <span style=color:#f92672>&amp;</span>accelerometer);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>configure</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>setPeriod</span>(<span style=color:#66d9ef>int</span> period);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getPeriod</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>requestUpdate</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>update</span>();
</span></span><span style=display:flex><span>        Sample3D <span style=color:#a6e22e>getSample</span>(CoordinateSystem coordinateSystem);
</span></span><span style=display:flex><span>        Sample3D <span style=color:#a6e22e>getSample</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getX</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getY</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getZ</span>();
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1675176782></script>
<script src=/js/perfect-scrollbar.min.js?1675176782></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1675176782></script>
<script src=/js/jquery.sticky.js?1675176782></script>
<script src=/js/featherlight.min.js?1675176782></script>
<script src=/js/highlight.pack.js?1675176782></script>
<script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1675176782></script>
<script src=/js/learn.js?1675176782></script>
<script src=/js/hugo-learn.js?1675176782></script>
<script src=/mermaid/mermaid.js?1675176782></script>
<script>mermaid.initialize({startOnLoad:!0})</script></body></html>