<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.110.0"><meta name=description content="An unofficial Microbit v2 API reference & guide book."><meta name=author content="c272"><link rel=icon href=/images/favicon.png type=image/png><title>MicroBit - micro:bit v2 Documentation</title><link href=/css/nucleus.css?1675177038 rel=stylesheet><link href=/css/fontawesome-all.min.css?1675177038 rel=stylesheet><link href=/css/hybrid.css?1675177038 rel=stylesheet><link href=/css/featherlight.min.css?1675177038 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1675177038 rel=stylesheet><link href=/css/auto-complete.css?1675177038 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1675177038 rel=stylesheet><link href=/css/theme.css?1675177038 rel=stylesheet><link href=/css/tabs.css?1675177038 rel=stylesheet><link href=/css/hugo-theme.css?1675177038 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1675177038></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style></head><body data-url=/api-reference/microbit-v2/microbit/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><img id=grav-logo src=/images/logo.png style=width:100%;height:100%></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1675177038></script>
<script type=text/javascript src=/js/auto-complete.js?1675177038></script>
<script type=text/javascript>var baseurl="https://microbit.c272.org/"</script><script type=text/javascript src=/js/search.js?1675177038></script></div><section id=homelinks><ul><li><a class=padding href=/><i class='fas fa-home'></i> Home</a></li></ul></section><div class=highlightable><ul class=topics><li data-nav-id=/setup/ title=Setup class=dd-item><a href=/setup/><b>1. </b>Setup</a><ul><li data-nav-id=/setup/linux-install-guide/ title="Installing on Linux" class=dd-item><a href=/setup/linux-install-guide/>Installing on Linux</a></li><li data-nav-id=/setup/mac-install-guide/ title="Installing on MacOS" class=dd-item><a href=/setup/mac-install-guide/>Installing on MacOS</a></li><li data-nav-id=/setup/windows-install-guide/ title="Installing on Windows" class=dd-item><a href=/setup/windows-install-guide/>Installing on Windows</a></li><li data-nav-id=/setup/using-micro-tools/ title="Configuring & Using micro-tools" class=dd-item><a href=/setup/using-micro-tools/>Configuring & Using micro-tools</a></li><li data-nav-id=/setup/debug-setup-guide/ title="Setting up a Debug Environment" class=dd-item><a href=/setup/debug-setup-guide/>Setting up a Debug Environment</a></li></ul></li><li data-nav-id=/guides/ title=Guides class=dd-item><a href=/guides/><b>2. </b>Guides</a><ul><li data-nav-id=/guides/hello-world/ title="'Hello World' with micro:bit v2" class=dd-item><a href=/guides/hello-world/>'Hello World' with micro:bit v2</a></li><li data-nav-id=/guides/using-the-filesystem/ title="Using the micro:bit file system" class=dd-item><a href=/guides/using-the-filesystem/>Using the micro:bit file system</a></li><li data-nav-id=/guides/logging/ title="Logging with MicroBitLog" class=dd-item><a href=/guides/logging/>Logging with MicroBitLog</a></li><li data-nav-id=/guides/serial/ title="Interacting over serial I/O" class=dd-item><a href=/guides/serial/>Interacting over serial I/O</a></li></ul></li><li data-nav-id=/api-reference/ title="API Reference" class="dd-item
parent"><a href=/api-reference/><b>3. </b>API Reference</a><ul><li data-nav-id=/api-reference/core/ title=codal-core class=dd-item><a href=/api-reference/core/>codal-core</a><ul><li data-nav-id=/api-reference/core/accelerometer/ title=Accelerometer class=dd-item><a href=/api-reference/core/accelerometer/>Accelerometer</a></li><li data-nav-id=/api-reference/core/button/ title=Button class=dd-item><a href=/api-reference/core/button/>Button</a></li><li data-nav-id=/api-reference/core/compass/ title=Compass class=dd-item><a href=/api-reference/core/compass/>Compass</a></li><li data-nav-id=/api-reference/core/coordinatespace/ title=CoordinateSpace class=dd-item><a href=/api-reference/core/coordinatespace/>CoordinateSpace</a></li><li data-nav-id=/api-reference/core/keyvaluestorage/ title=KeyValueStorage class=dd-item><a href=/api-reference/core/keyvaluestorage/>KeyValueStorage</a></li><li data-nav-id=/api-reference/core/ledmatrix/ title=LEDMatrix class=dd-item><a href=/api-reference/core/ledmatrix/>LEDMatrix</a></li><li data-nav-id=/api-reference/core/managedbuffer/ title=ManagedBuffer class=dd-item><a href=/api-reference/core/managedbuffer/>ManagedBuffer</a></li><li data-nav-id=/api-reference/core/managedstring/ title=ManagedString class=dd-item><a href=/api-reference/core/managedstring/>ManagedString</a></li><li data-nav-id=/api-reference/core/messagebus/ title=MessageBus class=dd-item><a href=/api-reference/core/messagebus/>MessageBus</a></li><li data-nav-id=/api-reference/core/multibutton/ title=MultiButton class=dd-item><a href=/api-reference/core/multibutton/>MultiButton</a></li><li data-nav-id=/api-reference/core/nvmcontroller/ title=NVMController class=dd-item><a href=/api-reference/core/nvmcontroller/>NVMController</a></li><li data-nav-id=/api-reference/core/pin/ title=Pin class=dd-item><a href=/api-reference/core/pin/>Pin</a></li><li data-nav-id=/api-reference/core/sample3d/ title=Sample3D class=dd-item><a href=/api-reference/core/sample3d/>Sample3D</a></li><li data-nav-id=/api-reference/core/timer/ title=Timer class=dd-item><a href=/api-reference/core/timer/>Timer</a></li><li data-nav-id=/api-reference/core/touchbutton/ title=TouchButton class=dd-item><a href=/api-reference/core/touchbutton/>TouchButton</a></li><li data-nav-id=/api-reference/core/license/ title="License & Attribution" class=dd-item><a href=/api-reference/core/license/>License & Attribution</a></li></ul></li><li data-nav-id=/api-reference/microbit-v2/ title=codal-microbit-v2 class="dd-item
parent"><a href=/api-reference/microbit-v2/>codal-microbit-v2</a><ul><li data-nav-id=/api-reference/microbit-v2/microbit/ title=MicroBit class="dd-item active"><a href=/api-reference/microbit-v2/microbit/>MicroBit</a></li><li data-nav-id=/api-reference/microbit-v2/microbitaudio/ title=MicroBitAudio class=dd-item><a href=/api-reference/microbit-v2/microbitaudio/>MicroBitAudio</a></li><li data-nav-id=/api-reference/microbit-v2/microbitblemanager/ title=MicroBitBLEManager class=dd-item><a href=/api-reference/microbit-v2/microbitblemanager/>MicroBitBLEManager</a></li><li data-nav-id=/api-reference/microbit-v2/microbitcompasscalibrator/ title=MicroBitCompassCalibrator class=dd-item><a href=/api-reference/microbit-v2/microbitcompasscalibrator/>MicroBitCompassCalibrator</a></li><li data-nav-id=/api-reference/microbit-v2/microbitdisplay/ title=MicroBitDisplay class=dd-item><a href=/api-reference/microbit-v2/microbitdisplay/>MicroBitDisplay</a></li><li data-nav-id=/api-reference/microbit-v2/microbiti2c/ title=MicroBitI2C class=dd-item><a href=/api-reference/microbit-v2/microbiti2c/>MicroBitI2C</a></li><li data-nav-id=/api-reference/microbit-v2/microbitio/ title=MicroBitIO class=dd-item><a href=/api-reference/microbit-v2/microbitio/>MicroBitIO</a></li><li data-nav-id=/api-reference/microbit-v2/microbitlog/ title=MicroBitLog class=dd-item><a href=/api-reference/microbit-v2/microbitlog/>MicroBitLog</a></li><li data-nav-id=/api-reference/microbit-v2/microbitpowermanager/ title=MicroBitPowerManager class=dd-item><a href=/api-reference/microbit-v2/microbitpowermanager/>MicroBitPowerManager</a></li><li data-nav-id=/api-reference/microbit-v2/microbitradio/ title=MicroBitRadio class=dd-item><a href=/api-reference/microbit-v2/microbitradio/>MicroBitRadio</a></li><li data-nav-id=/api-reference/microbit-v2/microbitthermometer/ title=MicroBitThermometer class=dd-item><a href=/api-reference/microbit-v2/microbitthermometer/>MicroBitThermometer</a></li><li data-nav-id=/api-reference/microbit-v2/microbitusbflashmanager/ title=MicroBitUSBFlashManager class=dd-item><a href=/api-reference/microbit-v2/microbitusbflashmanager/>MicroBitUSBFlashManager</a></li><li data-nav-id=/api-reference/microbit-v2/license/ title="License & Attribution" class=dd-item><a href=/api-reference/microbit-v2/license/>License & Attribution</a></li></ul></li><li data-nav-id=/api-reference/nrf52/ title=codal-nrf52 class=dd-item><a href=/api-reference/nrf52/>codal-nrf52</a><ul><li data-nav-id=/api-reference/nrf52/nrf52adc/ title=NRF52ADC class=dd-item><a href=/api-reference/nrf52/nrf52adc/>NRF52ADC</a></li><li data-nav-id=/api-reference/nrf52/nrf52flashmanager/ title=NRF52FlashManager class=dd-item><a href=/api-reference/nrf52/nrf52flashmanager/>NRF52FlashManager</a></li><li data-nav-id=/api-reference/nrf52/nrf52pin/ title=NRF52Pin class=dd-item><a href=/api-reference/nrf52/nrf52pin/>NRF52Pin</a></li><li data-nav-id=/api-reference/nrf52/nrf52serial/ title=NRF52Serial class=dd-item><a href=/api-reference/nrf52/nrf52serial/>NRF52Serial</a></li><li data-nav-id=/api-reference/nrf52/nrf52touchsensor/ title=NRF52TouchSensor class=dd-item><a href=/api-reference/nrf52/nrf52touchsensor/>NRF52TouchSensor</a></li><li data-nav-id=/api-reference/nrf52/nrflowleveltimer/ title=NRFLowLevelTimer class=dd-item><a href=/api-reference/nrf52/nrflowleveltimer/>NRFLowLevelTimer</a></li><li data-nav-id=/api-reference/nrf52/license/ title="License & Attribution" class=dd-item><a href=/api-reference/nrf52/license/>License & Attribution</a></li></ul></li></ul></li></ul><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> by <a href=https://github.com/c272>C272</a>.<br></p><p style=color:#64586e;margin-top:.5em>This site is not affiliated, associated, authorized, or endorsed by the BBC or Lancaster University.</p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/>Home</a> > <a href=/api-reference/>API Reference</a> > <a href=/api-reference/microbit-v2/>codal-microbit-v2</a> > MicroBit</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#usage--examples>Usage & Examples</a></li><li><a href=#static-methods>Static Methods</a><ul><li><a href=#getserial>getSerial()</a></li></ul></li><li><a href=#methods>Methods</a><ul><li><a href=#microbit>MicroBit()</a></li><li><a href=#init>init()</a></li><li><a href=#sleepuint32_t>sleep(uint32_t)</a></li><li><a href=#scheduleridle>schedulerIdle()</a></li><li><a href=#idlecallback>idleCallback()</a></li><li><a href=#systemtime>systemTime()</a></li><li><a href=#eraseuserstoragebool>eraseUserStorage(bool)</a></li></ul></li><li><a href=#members>Members</a><ul><li><a href=#blemanager>bleManager</a></li><li><a href=#ble>ble</a></li><li><a href=#systemtimer>systemTimer</a></li><li><a href=#adctimer>adcTimer</a></li><li><a href=#captouchtimer>capTouchTimer</a></li><li><a href=#timer>timer</a></li><li><a href=#messagebus>messageBus</a></li><li><a href=#adc>adc</a></li><li><a href=#touchsensor>touchSensor</a></li><li><a href=#io>io</a></li><li><a href=#serial>serial</a></li><li><a href=#i2c>i2c</a></li><li><a href=#power>power</a></li><li><a href=#flash>flash</a></li><li><a href=#internalflash>internalFlash</a></li><li><a href=#storage>storage</a></li><li><a href=#ledrowpins>ledRowPins[]</a></li><li><a href=#ledcolpins>ledColPins[]</a></li><li><a href=#ledmatrixmap>ledMatrixMap</a></li><li><a href=#display>display</a></li><li><a href=#buttona>buttonA</a></li><li><a href=#buttonb>buttonB</a></li><li><a href=#buttonab>buttonAB</a></li><li><a href=#logo>logo</a></li><li><a href=#radio>radio</a></li><li><a href=#thermometer>thermometer</a></li><li><a href=#accelerometer>accelerometer</a></li><li><a href=#compass>compass</a></li><li><a href=#compasscalibrator>compassCalibrator</a></li><li><a href=#audio>audio</a></li><li><a href=#log>log</a></li></ul></li><li><a href=#class-definition>Class Definition</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>MicroBit</h1><div style=margin:auto;text-align:center;width:><p>Represents the micro:bit v2 in its entirety. Allows for convenient access to device drivers to control the micro:bit&rsquo;s various hardware elements.</p><p><strong>Version:</strong> <code>3f173e7</code><br><strong>Canonical type name:</strong> <code>codal::MicroBit</code><br><strong>Defined within:</strong> <code>model/MicroBit.h</code></p></div><h2 id=usage--examples>Usage & Examples</h2><p>In most projects, the <code>MicroBit</code> class will be one of the first things instantiated and brought up after entering <code>main()</code>. Without this, the scheduler will not be running and the message bus will not be brought up. To start a normal micro:bit project, you can do something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;MicroBit.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>MicroBit uBit;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>//Initialise the scheduler, BLE, etc.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    uBit.init();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//Scroll some cool stuff on the screen!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>while</span> (true)
</span></span><span style=display:flex><span>        uBit.display.scroll(<span style=color:#e6db74>&#34;Hello micro:bit!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=static-methods>Static Methods</h2><h3 id=getserial>getSerial()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>static</span> ManagedString <span style=color:#a6e22e>getSerial</span>();
</span></span></code></pre></div><p>Returns the serial number of the micro:bit v2.</p><p><strong>Returns</strong> - A <a href=/api-reference/core/managedstring/>ManagedString</a> containing the serial number of the device.</p><h2 id=methods>Methods</h2><h3 id=microbit>MicroBit()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MicroBit();
</span></span></code></pre></div><p>Constructs the device representation, including some of the hardware driver member variables on the board. <strong>Does not</strong> completely initialise all device drivers, this must be performed by calling <code>init()</code>.</p><h3 id=init>init()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>init</span>();
</span></span></code></pre></div><p>Completes initialisation of the device representation for various driver components, namely the Bluetooth stack (if <code>DEVICE_BLE</code> is enabled), message bus events, scheduler and IRQ priorities.</p><p><strong>Returns</strong> - <code>DEVICE_OK</code> upon first call. All subsequent calls will return <code>DEVICE_NOT_SUPPORTED</code> (the class is already initialised).</p><h3 id=sleepuint32_t>sleep(uint32_t)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sleep</span>(<span style=color:#66d9ef>uint32_t</span> milliseconds);
</span></span></code></pre></div><p>Delays the current fiber (thread) for the given number of milliseconds. If the scheduler is not running or this is called within an interrupt context, the method will busywait instead. To instead perform a blocking operation, call one of the <code>wait(n)</code> methods (<code>wait_ms</code>, <code>wait_us</code>) instead.</p><p><strong>Parameters</strong><br>- <code>milliseconds</code> (<em>uint32</em>): The number of milliseconds to suspend execution for.</p><h3 id=scheduleridle>schedulerIdle()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>schedulerIdle</span>() <span style=color:#66d9ef>override</span>;
</span></span></code></pre></div><p>Performs a scheduler idle, putting the device into deep sleep mode. If BLE is enabled and is currently connected to something, this will exit without entering deep sleep mode.</p><h3 id=idlecallback>idleCallback()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>idleCallback</span>();
</span></span></code></pre></div><p>Called periodically by the fiber scheduler for idle processing. Used internally by <code>MicroBit</code> to flush the <code>DMESG</code> buffer for serial debug, but can be overridden by inheriting classes.</p><h3 id=systemtime>systemTime()</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> <span style=color:#a6e22e>systemTime</span>();
</span></span></code></pre></div><p>Determines the time since the micro:bit was last reset, in milliseconds. Currently, this counter overflows without error after roughly 1.6 months.</p><p><strong>Returns</strong> - The time, in milliseconds, since the device was last reset.</p><h3 id=eraseuserstoragebool>eraseUserStorage(bool)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>eraseUserStorage</span>(<span style=color:#66d9ef>bool</span> forceErase <span style=color:#f92672>=</span> false);
</span></span></code></pre></div><p>Helper function to erase user storage after the micro:bit is reprogrammed. If <code>forceErase</code> is set to false, the storage will only be erased if the device has just been reprogrammed and <code>CONFIG_MICROBIT_ERASE_USER_DATA_ON_REFLASH</code> is enabled. Otherwise, if <code>forceErase</code> is set to true, the data will be erased without checks.</p><p><strong>Parameters</strong><br>- <code>forceErase</code> (<em>bool</em>): Whether to erase user storage data without performing checks to determine its necessity.</p><h2 id=members>Members</h2><h3 id=blemanager>bleManager</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#if CONFIG_ENABLED(DEVICE_BLE)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    MicroBitBLEManager bleManager;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span></code></pre></div><p>An instance of <a href=/api-reference/microbit-v2/microbitblemanager/>MicroBitBLEManager</a> which allows the user to manage bluetooth pairing and connections for the micro:bit&rsquo;s onboard bluetooth stack.</p><h3 id=ble>ble</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#if CONFIG_ENABLED(DEVICE_BLE)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    BLEDevice <span style=color:#f92672>*</span>ble;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span></code></pre></div><p>A representation of the Bluetooth low energy device that is attached to the micro:bit. For the micro:bit v2 API, this is simply a pointer to <code>bleManager</code>.</p><h3 id=systemtimer>systemTimer</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>NRFLowLevelTimer systemTimer;
</span></span></code></pre></div><p>An <a href=/api-reference/nrf52/nrflowleveltimer/>NRFLowLevelTimer</a> representing the micro:bit v2&rsquo;s main system timer.</p><h3 id=adctimer>adcTimer</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>NRFLowLevelTimer adcTimer;
</span></span></code></pre></div><p>An <a href=/api-reference/nrf52/nrflowleveltimer/>NRFLowLevelTimer</a> that drives the micro:bit v2&rsquo;s ADC (analogue to digital converter).</p><h3 id=captouchtimer>capTouchTimer</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>NRFLowLevelTimer capTouchTimer;
</span></span></code></pre></div><p>An <a href=/api-reference/nrf52/nrflowleveltimer/>NRFLowLevelTimer</a> at <code>NRF_TIMER3</code>, used to drive the micro:bit v2&rsquo;s <code>touchSensor</code> capacitive touch sensor mechanism.</p><h3 id=timer>timer</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>Timer timer;
</span></span></code></pre></div><p>An instance of the higher level <a href=/api-reference/core/timer/>Timer</a> API provided by the CODAL core library. Wraps <a href=/api-reference/nrf52/nrflowleveltimer/>NRFLowLevelTimer</a> to provide a high level interface for interacting with the system timer. You can interface with this in place of <code>systemTimer</code> if you wish to use a simpler interface which integrates with CODAL event handling.</p><h3 id=messagebus>messageBus</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MessageBus messageBus;
</span></span></code></pre></div><p>A CODAL <a href=/api-reference/core/messagebus/>MessageBus</a> which allows for the processing of asynchronous events on the micro:bit. Allows for the hooking and processing of events from other micro:bit hardware elements such as buttons, BLE and asynchronous serial.</p><h3 id=adc>adc</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>NRF52ADC adc;
</span></span></code></pre></div><p>Instance of a DMA-enabled analogue to digital converter <a href=/api-reference/nrf52/nrf52adc/>NRF52ADC</a>. Enables the use of multiplexed DMA/ADC channels, and is driven by the low level timer <code>adcTimer</code>.</p><h3 id=touchsensor>touchSensor</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>NRF52TouchSensor touchSensor;
</span></span></code></pre></div><p>A capacitive touch sensor <a href=/api-reference/nrf52/nrf52touchsensor/>NRF52TouchSensor</a> for pins on the micro:bit v2. Allows for the configuration of pins as &ldquo;buttons&rdquo; which, when pressed, will turn high.</p><h3 id=io>io</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MicroBitIO io;
</span></span></code></pre></div><p>Pin-based IO interaction provided through <a href=/api-reference/microbit-v2/microbitio/>MicroBitIO</a>. Contains representations of all pins on the micro:bit v2 as <a href=/api-reference/nrf52/nrf52pin/>NRF52Pin</a> instances.</p><h3 id=serial>serial</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>NRF52Serial serial;
</span></span></code></pre></div><p>An <a href=/api-reference/nrf52/nrf52serial/>NRF52Serial</a> instance, allowing for serial communication over USB UART. Only allows for serial UART over the micro:bit&rsquo;s USB port, if serial over a different set of pins is required then you should make a separate instance of <a href=/api-reference/nrf52/nrf52serial/>NRF52Serial</a>.</p><h3 id=i2c>i2c</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MicroBitI2C i2c;
</span></span></code></pre></div><p>An instance of <a href=/api-reference/microbit-v2/microbiti2c/>MicroBitI2C</a> which allows for the use of an <a href=https://en.wikipedia.org/wiki/I%C2%B2C>I2C Protocol</a> bus over pins <code>P20</code> (<code>sda</code>) and <code>P19</code> (<code>scl</code>). I2C interfaces over other pins should create a separate instance of <a href=/api-reference/microbit-v2/microbiti2c/>MicroBitI2C</a>.</p><h3 id=power>power</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MicroBitPowerManager power;
</span></span></code></pre></div><p>The device&rsquo;s <a href=/api-reference/microbit-v2/microbitpowermanager/>MicroBitPowerManager</a>. Contains power state information for the device, and allows for the control of deep sleep modes, as well as the sending and receiving of control packets to the USB interface chip.</p><h3 id=flash>flash</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MicroBitUSBFlashManager flash;
</span></span></code></pre></div><p><a href=/api-reference/microbit-v2/microbitusbflashmanager/>MicroBitUSBFlashManager</a> instance. An interface to the micro:bit&rsquo;s USB interface and USB storage area, allowing for the revealing and hiding of the USB file on the mounted drive, as well as arbitrary read and write from the USB storage area. Provides access to size and page information for the attached flash.</p><h3 id=internalflash>internalFlash</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>NRF52FlashManager internalFlash;
</span></span></code></pre></div><p>The underlying <a href=/api-reference/nrf52/nrf52flashmanager/>NRF52FlashManager</a> interface which provides functions for reading and writing arbitrary portions of flash memory. Also provides information on the attached flash.</p><h3 id=storage>storage</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MicroBitStorage storage;
</span></span></code></pre></div><p><code>typedef</code> aliased instance of CODAL&rsquo;s <a href=/api-reference/core/keyvaluestorage/>KeyValueStorage</a> class. Allows for persistent key-value pair style storage. This storage is buffered with a scratch page, and backed by the micro:bit&rsquo;s flash.</p><h3 id=ledrowpins>ledRowPins[]</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>NRF52Pin<span style=color:#f92672>*</span> ledRowPins[<span style=color:#ae81ff>5</span>];
</span></span></code></pre></div><p>The micro:bit&rsquo;s internal LED row pins, represented as <a href=/api-reference/nrf52/nrf52pin/>NRF52Pin</a> instances.</p><h3 id=ledcolpins>ledColPins[]</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>NRF52Pin<span style=color:#f92672>*</span> ledColPins[<span style=color:#ae81ff>5</span>];
</span></span></code></pre></div><p>The micro:bit&rsquo;s internal LED column pins, represented as <a href=/api-reference/nrf52/nrf52pin/>NRF52Pin</a> instances.</p><h3 id=ledmatrixmap>ledMatrixMap</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>const</span> MatrixMap ledMatrixMap;
</span></span></code></pre></div><p>A map representing the LED matrix on the front of the micro:bit, as a CODAL <a href=/api-reference/core/ledmatrix#matrixmap>MatrixMap</a>.</p><h3 id=display>display</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MicroBitDisplay display;
</span></span></code></pre></div><p>Instance of <a href=/api-reference/microbit-v2/microbitdisplay/>MicroBitDisplay</a>. Represents an interface to interact with the &lsquo;display&rsquo; (LED matrix) on the micro:bit, with support for text rendering, scrolling text, as well as displaying animations and primitive images.</p><h3 id=buttona>buttonA</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>Button buttonA;
</span></span></code></pre></div><p>A <a href=/api-reference/core/button/>Button</a> interface which represents the button labeled &lsquo;A&rsquo; on the micro:bit&rsquo;s face.</p><h3 id=buttonb>buttonB</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>Button buttonB;
</span></span></code></pre></div><p>A <a href=/api-reference/core/button/>Button</a> interface which represents the button labeled &lsquo;B&rsquo; on the micro:bit&rsquo;s face.</p><h3 id=buttonab>buttonAB</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MultiButton buttonAB;
</span></span></code></pre></div><p>A <a href=/api-reference/core/multibutton/>MultiButton</a> interface which represents the two buttons &lsquo;A&rsquo; and &lsquo;B&rsquo; on the micro:bit&rsquo;s face as a group. This can be used to detect, for example, when both buttons are pressed at the same time.</p><h3 id=logo>logo</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>TouchButton logo;
</span></span></code></pre></div><p>A <a href=/api-reference/core/touchbutton/>TouchButton</a> interface which represents the logo on the face of the micro:bit. A main use of this is to detect when someone touches the logo &lsquo;pin&rsquo;.</p><h3 id=radio>radio</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MicroBitRadio radio;
</span></span></code></pre></div><p>An instance of <a href=/api-reference/microbit-v2/microbitradio/>MicroBitRadio</a>. This facilitates the sending and receiving of data over specific radio frequencies (from 2400MHz through 2500MHz, in 1MHz bands) with buffering.</p><h3 id=thermometer>thermometer</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MicroBitThermometer thermometer;
</span></span></code></pre></div><p><a href=/microbit-v2/microbitthermometer/>MicroBitThermometer</a> instance. Infers the ambient temperature based on the surface temperature readings of various chips on the micro:bit.</p><h3 id=accelerometer>accelerometer</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>Accelerometer<span style=color:#f92672>&amp;</span> accelerometer;
</span></span></code></pre></div><p>A CODAL <a href=/api-reference/core/accelerometer/>Accelerometer</a> abstraction. Allows for reading of the micro:bit&rsquo;s built in accelerometer data, as well as the configuration of the sample rate and range.</p><h3 id=compass>compass</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>Compass<span style=color:#f92672>&amp;</span> compass;
</span></span></code></pre></div><p>A CODAL <a href=/api-reference/core/compass/>Compass</a> abstraction. Reads the magnetometer to determine the orientation of the device, applying tilt compensation from data provided by the accelerometer.</p><h3 id=compasscalibrator>compassCalibrator</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MicroBitCompassCalibrator compassCalibrator;
</span></span></code></pre></div><p>The micro:bit calibration manager for the CODAL <a href=/api-reference/core/compass/>Compass</a>, represented in a <a href=/api-reference/microbit-v2/microbitcompasscalibrator/>MicroBitCompassCalibrator</a> instance. Performs a least mean squares optimisation of results from sample data to obtain calibration data for the compass. Can also help prompt the user to collect required sample data by moving around the micro:bit with a small LED game.</p><h3 id=audio>audio</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MicroBitAudio audio;
</span></span></code></pre></div><p>Represents the audio API for the micro:bit v2, as <a href=/api-reference/microbit-v2/microbitaudio/>MicroBitAudio</a>. Allows for multi-stream audio playback with a basic mixer, as well as synthesiser support for small sound bytes. Also contains a reference to the microphone ADC channel.</p><h3 id=log>log</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>MicroBitLog log;
</span></span></code></pre></div><p>The <a href=/api-reference/microbit-v2/microbitlog/>MicroBitLog</a> interface. Provides easy to set up logging functionality for the micro:bit, generating data which can be viewed in HTML from the mounted USB partition on a PC.</p><h2 id=class-definition>Class Definition</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MicroBit</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> MicroBitDevice, <span style=color:#66d9ef>public</span> CodalComponent
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#if CONFIG_ENABLED(DEVICE_BLE)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        MicroBitBLEManager          bleManager;
</span></span><span style=display:flex><span>        BLEDevice                  <span style=color:#f92672>*</span>ble;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        NRFLowLevelTimer            systemTimer;
</span></span><span style=display:flex><span>        NRFLowLevelTimer            adcTimer;
</span></span><span style=display:flex><span>        NRFLowLevelTimer            capTouchTimer;
</span></span><span style=display:flex><span>        Timer                       timer;
</span></span><span style=display:flex><span>        MessageBus                  messageBus;
</span></span><span style=display:flex><span>        NRF52ADC                    adc;
</span></span><span style=display:flex><span>        NRF52TouchSensor            touchSensor;
</span></span><span style=display:flex><span>        MicroBitIO                  io;
</span></span><span style=display:flex><span>        NRF52Serial                 serial;
</span></span><span style=display:flex><span>        MicroBitI2C                 i2c;
</span></span><span style=display:flex><span>        MicroBitPowerManager        power;
</span></span><span style=display:flex><span>        MicroBitUSBFlashManager     flash;
</span></span><span style=display:flex><span>        NRF52FlashManager           internalFlash; 
</span></span><span style=display:flex><span>        MicroBitStorage             storage;
</span></span><span style=display:flex><span>        NRF52Pin<span style=color:#f92672>*</span>                   ledRowPins[<span style=color:#ae81ff>5</span>];
</span></span><span style=display:flex><span>        NRF52Pin<span style=color:#f92672>*</span>                   ledColPins[<span style=color:#ae81ff>5</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> MatrixMap             ledMatrixMap;
</span></span><span style=display:flex><span>        MicroBitDisplay             display;
</span></span><span style=display:flex><span>        Button                      buttonA;
</span></span><span style=display:flex><span>        Button                      buttonB;
</span></span><span style=display:flex><span>        MultiButton                 buttonAB;
</span></span><span style=display:flex><span>        TouchButton                 logo;
</span></span><span style=display:flex><span>        MicroBitRadio               radio;
</span></span><span style=display:flex><span>        MicroBitThermometer         thermometer;
</span></span><span style=display:flex><span>        Accelerometer<span style=color:#f92672>&amp;</span>              accelerometer;
</span></span><span style=display:flex><span>        Compass<span style=color:#f92672>&amp;</span>                    compass;
</span></span><span style=display:flex><span>        MicroBitCompassCalibrator   compassCalibrator;
</span></span><span style=display:flex><span>        MicroBitAudio               audio;
</span></span><span style=display:flex><span>        MicroBitLog                 log;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>static</span> ManagedString <span style=color:#a6e22e>getSerial</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        MicroBit();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>init</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sleep</span>(<span style=color:#66d9ef>uint32_t</span> milliseconds);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>schedulerIdle</span>() <span style=color:#66d9ef>override</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>idleCallback</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> <span style=color:#a6e22e>systemTime</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>eraseUserStorage</span>(<span style=color:#66d9ef>bool</span> forceErase <span style=color:#f92672>=</span> false);
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1675177038></script>
<script src=/js/perfect-scrollbar.min.js?1675177038></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1675177038></script>
<script src=/js/jquery.sticky.js?1675177038></script>
<script src=/js/featherlight.min.js?1675177038></script>
<script src=/js/highlight.pack.js?1675177038></script>
<script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1675177038></script>
<script src=/js/learn.js?1675177038></script>
<script src=/js/hugo-learn.js?1675177038></script>
<script src=/mermaid/mermaid.js?1675177038></script>
<script>mermaid.initialize({startOnLoad:!0})</script></body></html>